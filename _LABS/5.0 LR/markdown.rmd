---
title: "Лабораторная работа №5.0"
output: html_document
---

**Цель работы:** Научиться следующим навыкам:

####
1. Использование датафреймов для статистических вычислений;
2. Преобразование данных для удобной работы с ними;
3. Линейные модели.

### Загрузка исходных данных
Проанализируйте данные о возрасте и физ. характеристиках молюсков

```{r}
datafrm <- read.csv("https://archive.ics.uci.edu/ml/machine-learning-databases/abalone/abalone.data", header = TRUE, sep = ",")
summary(datafrm)
colnames(datafrm)
colnames(datafrm) <- c("sex", "length", "diameter", "height",
                "whole_weight", "shucked_weight",
                "viscera_weight", "shell_weight", "rings")

colnames(datafrm)
datafrm$sex <- factor(c("Female", "Infant", "Male")[datafrm$sex])
par(mfrow = c(1, 3))
hist(datafrm$diameter, main = "Диаметр, мм")
hist(datafrm$height, main = "Высота, мм")
hist(datafrm$whole_weight, main = "Полный вес, гр")
```

Видим ассиметрию и выбросы (от них нужно избавиться)

### Визулизируем возможные зависимости

```{r}
par(mfrow = c(1, 2))
plot(datafrm$diameter, datafrm$whole_weight, 'p', main = "Зависимость веса от диаметра")
plot(datafrm$height, datafrm$whole_weight, 'p', main = "Зависимость веса от высоты")
```

Хорошо видна зависимость, нужно её исследовать. 

```{r, echo=FALSE}
par(mfrow = c(1, 1))
par(ask = F)
```

### Построить линейные модели при помощи функции lm, посмотреть их характеристики

```{r}
linear.model.d_w <- lm(datafrm$diameter ~ datafrm$whole_weight, data = datafrm)
summary(linear.model.d_w)
linear.model.h_w <- lm(datafrm$height ~ datafrm$whole_weight, data = datafrm)
summary(linear.model.h_w)

plot(linear.model.d_w, main = "Зависимость веса от диаметра")
plot(linear.model.h_w, main = "Зависимость веса от высоты")
```

### Избавиться от выборосов, построить ещё модели и проверить их

```{r}
datafrm.noout <- datafrm[datafrm$height < 0.4 & datafrm$diameter > 0.2 & datafrm$diameter < 0.6 & datafrm$whole_weight < 1.7 & datafrm$whole_weight > 0.1,]
par(mfrow = c(1, 3))
hist(datafrm.noout$diameter, main = "Диаметр, мм")
hist(datafrm.noout$height, main = "Высота, мм")
hist(datafrm.noout$whole_weight, main = "Полный вес, гр")
par(mfrow = c(1, 1))

linear.model.d_w <- lm(datafrm.noout$diameter ~ datafrm.noout$whole_weight, data = datafrm.noout)
summary(linear.model.d_w)
linear.model.h_w <- lm(datafrm.noout$height ~ datafrm.noout$whole_weight, data = datafrm.noout)
summary(linear.model.h_w)

plot(linear.model.d_w, main = "Зависимость веса от диаметра")
plot(linear.model.h_w, main = "Зависимость веса от высоты")
```

### разделить массив данных на 2 случайные части

```{r}
datalength <- nrow(datafrm.noout)
testindex <- seq(1, trunc(datalength * 0.7), by = 1)
controlindex <- seq(round(datalength * 0.3) + 1, datalength, by = 1)
sample.test <- datafrm.noout[testindex,]
sample.control <- datafrm.noout[controlindex,]
```

### подогнать модель по первой части

```{r}
linear.model.d_w <- lm(sample.test$diameter ~ sample.test$whole_weight, data = sample.test)
linear.model.h_w <- lm(sample.test$height ~ sample.test$whole_weight, data = sample.test)

plot(linear.model.d_w, main = "Зависимость веса от диаметра")
plot(linear.model.h_w, main = "Зависимость веса от высоты")
```

### спрогнозировать (функция predict) значения во второй части

```{r}
predicted.d_w <- predict(linear.model.d_w, sample.control)
predicted.h_w <- predict(linear.model.h_w, sample.control)
```

### проверить качесвто прогноза

```{r}
cor(sample.control$whole_weight, predicted.d_w)
cor(sample.control$whole_weight, predicted.h_w)
```

# Заключение

В ходе выполнения данной работы я получил незабываемый опыт и приобрел навыки, которые пригодятся в дальнейшей профессиональной деятельности. 
Были изучены и освоены на практике основы анализа данных. Прогноз исследуемых моделей получился достаточно точным.

***

С уважением,

студент гр. РИ-440005

Кабанов Евгений